<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="HackPDM.Forms.Hack.HackFileManager"
    xmlns="using:Microsoft.UI.Xaml.Controls"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:HackPDM.Data"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sys="using:System"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:xaml="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    mc:Ignorable="d">

    <Grid Margin="12">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" MaxHeight="400" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  TreeView for Directories  -->
        <TreeView
            x:Name="OdooDirectoryTree"
            Grid.Row="0"
            Grid.RowSpan="2"
            Grid.Column="0"
            Width="321"
            Margin="0,0,10,0"
            VerticalAlignment="Stretch">
            <TreeView.ContextFlyout>
                <MenuFlyout>
                    <MenuFlyoutItem x:Name="TreeGetLatest" Text="Get Latest" />
                    <MenuFlyoutSeparator />
                    <MenuFlyoutItem x:Name="TreeCheckout" Text="Checkout" />
                    <MenuFlyoutItem x:Name="TreeCommit" Text="Commit" />
                    <MenuFlyoutItem x:Name="TreeUndoCheckout" Text="Undo Checkout" />
                    <MenuFlyoutSeparator />
                    <MenuFlyoutItem x:Name="TreeAnalyze" Text="Analyze" />
                    <MenuFlyoutSeparator />
                    <MenuFlyoutItem x:Name="TreeDelete" Text="Delete" />
                    <MenuFlyoutItem x:Name="TreeLogicalDelete" Text="Logical Delete" />
                    <MenuFlyoutItem x:Name="TreePermanentDelete" Text="Permanent Delete" />
                    <MenuFlyoutItem x:Name="TreeUndelete" Text="UnDelete" />
                    <MenuFlyoutItem x:Name="TreeLocalDelete" Text="Local Delete" />
                    <MenuFlyoutSeparator />
                    <MenuFlyoutItem x:Name="TreeOpenDirectory" Text="Open Directory" />
                </MenuFlyout>
            </TreeView.ContextFlyout>
            <TreeView.ItemTemplate>
                <xaml:DataTemplate x:DataType="local:TreeData">
                    <TreeViewItem Loaded="TreeViewItem_Loaded" Unloaded="TreeViewItem_Unloaded">
                        <StackPanel Orientation="Horizontal">
                            <Image
                                Width="16"
                                Height="16"
                                Margin="0,0,4,0"
                                Source="{x:Bind Icon}" />
                            <TextBlock Text="{x:Bind Name}" />
                        </StackPanel>
                    </TreeViewItem>
                </xaml:DataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>

        <!--  TabView for file lists  -->
        <TabView
            x:Name="ListTabs"
            Grid.Row="0"
            Grid.RowSpan="2"
            Grid.Column="1"
            Margin="0,0,10,0">

            <TabViewItem Header="Entries" IsClosable="False">
                <ListView x:Name="OdooEntryList">
                    <ListView.ContextFlyout>
                        <MenuFlyout>
                            <MenuFlyoutItem x:Name="ListGetLatest" Text="Get Latest" />
                            <MenuFlyoutItem x:Name="ListCheckout" Text="Checkout" />
                            <MenuFlyoutItem x:Name="ListCommit" Text="Commit" />
                            <MenuFlyoutItem x:Name="ListUndoCheckout" Text="Undo Checkout" />
                            <MenuFlyoutItem x:Name="ListDelete" Text="Delete" />
                            <MenuFlyoutSubItem x:Name="ListOpen" Text="Open">
                                <MenuFlyoutItem x:Name="ListPreview" Text="Preview Latest Remote" />
                                <MenuFlyoutItem x:Name="ListLocal" Text="Latest Local" />
                                <MenuFlyoutItem x:Name="ListFileDirectory" Text="File Directory" />
                            </MenuFlyoutSubItem>
                        </MenuFlyout>
                    </ListView.ContextFlyout>
                    <ListView.ItemTemplate>
                        <xaml:DataTemplate x:DataType="local:EntryRow">
                            <ListViewItem>
                                <StackPanel Orientation="Horizontal">
                                    <Image
                                        Width="32"
                                        Height="32"
                                        Margin="0,0,5,0"
                                        Source="{x:Bind Icon}" />
                                    <TextBlock Text="{x:Bind Name}" />
                                    <TextBlock Text="{x:Bind Category}" />
                                    <TextBlock Text="{x:Bind Checkout}" />
                                    <TextBlock Text="{x:Bind LocalDate}" />
                                    <TextBlock Text="{x:Bind RemoteDate}" />
                                    <TextBlock Text="{x:Bind FullName}" />
                                </StackPanel>
                            </ListViewItem>
                        </xaml:DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </TabViewItem>
            <TabViewItem Header="Changes" IsClosable="False">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <ListView x:Name="HackChangesList" Grid.Column="0" />
                    <ListView x:Name="OdooChangesList" Grid.Column="1" />
                </Grid>
            </TabViewItem>
        </TabView>

        <!--  Right-side controls (image, version tabs)  -->
        <TabView
            x:Name="VersionTabs"
            Grid.Row="2"
            Grid.RowSpan="2"
            Grid.Column="1"
            Grid.ColumnSpan="1"
            Margin="10,0,0,0">
            <TabViewItem x:Name="HistoryTab" Header="History">
                <ListView x:Name="OdooHistory" />
            </TabViewItem>
            <TabViewItem x:Name="ParentTab" Header="Where Used">
                <ListView x:Name="OdooParents" />
            </TabViewItem>
            <TabViewItem x:Name="ChildTab" Header="Dependents">
                <ListView x:Name="OdooChildren" />
            </TabViewItem>
            <TabViewItem x:Name="PropertiesTab" Header="Properties">
                <ListView x:Name="OdooProperties" />
            </TabViewItem>
            <TabViewItem x:Name="InfoTab" Header="Info">
                <ListView x:Name="OdooVersionInfoList" />
            </TabViewItem>
        </TabView>

        <!--  Image Panel  -->
        <Border
            Grid.Row="0"
            Grid.RowSpan="1"
            Grid.Column="2"
            Margin="10,0,0,10">
            <Image
                x:Name="OdooEntryImage"
                Width="256"
                Height="274"
                Source="ms-appx:///Assets/placeholder.png"
                Stretch="UniformToFill" />
        </Border>

        <!--  Bottom Controls  -->
        <Grid
            Grid.Row="2"
            Grid.Column="0"
            Grid.ColumnSpan="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <CheckBox
                x:Name="ShowInactive"
                Grid.Column="1"
                Margin="0,0,10,0"
                VerticalAlignment="Center"
                Content="Show Deleted" />
            <CommandBar
                x:Name="MoreTools"
                Grid.Column="2"
                DefaultLabelPosition="Right">
                <AppBarButton
                    x:Name="AdditionalTools"
                    Icon="More"
                    Label="Additional Tools">
                    <AppBarButton.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem x:Name="OdooRefreshDropdown" Text="Refresh View" />
                            <MenuFlyoutItem x:Name="OdooSearchDropdown" Text="Search" />
                            <MenuFlyoutItem x:Name="OdooManageTypesDropdown" Text="Manage File Types" />
                        </MenuFlyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
            </CommandBar>
        </Grid>
    </Grid>
</Page>
